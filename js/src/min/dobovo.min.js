function display_seo_text(){$("#dbv_seo_text").length&&$("#dbv_seo_block").length&&$("#dbv_seo_block").html($("#dbv_seo_text").html()).show()}function lang_propose(){if(!$.cookie("DOBOVO_OLDUSER")){$.cookie("DOBOVO_OLDUSER",1,{expires:10,path:"/"});var t=$("#dbv_lang_selector").parent().find(".currency__text").text().toUpperCase(),a=navigator.language||navigator.userLanguage;if(a=a.substr(0,2).toUpperCase(),t!=a){var e;$("#dbv_lang_selector>li").each(function(){var t=$("a",this).text();if(t==a){var n=$(this).attr("title"),d=n.split(" ").pop();n=n.replace(/\S+\s*$/,""),e=n+'<a href="'+$("a",this).attr("href")+'">'+d+"</a>"}}),e.length>0&&($("body").prepend("<div id=dbv_lang_propose></div>"),$("#dbv_lang_propose").html('<button onClick="$(this).parent().hide()"></button>'+e).slideDown(1e3))}}}function dbv_change_currency(t){var a=$.cookie("Currency")||"uah";a=a.toUpperCase();var e=t?t:a;e==a&&t||($.cookie("Currency",e.toLowerCase(),{expires:10,path:"/"}),$(".dbv_price").each(function(){$(".dbv_orig",this).length||$(".dbv_val",this).after('<span class=dbv_orig style="display: none">'+$(".dbv_val",this).text()+"</span>"),$(".dbv_val",this).text(dbv_currency_convert("UAH",e,$(".dbv_orig",this).text())),$(".dbv_cur",this).text(e)}),$(".dbv_price_round").each(function(){$(".dbv_orig",this).length||$(".dbv_val",this).after('<span class=dbv_orig style="display: none">'+$(".dbv_val",this).text()+"</span>"),$(".dbv_val",this).text(dbv_currency_convert("UAH",e,$(".dbv_orig",this).text(),0)),$(".dbv_cur",this).text(e)})),$("#current_currency").text(e)}function dbv_currency_convert(t,a,e,n){"undefined"==typeof n&&(n=2);var d=Math.round(e*(window.dbv_CurrencyRates[t]/window.dbv_CurrencyRates[a])*100)/100;return d.toFixed(n)}function dbv_load_currency_rates(){var t=dbv_get_static_url()+"/currencyRates.js";$.getScript(t,function(){dbv_change_currency()})}function dbv_get_static_url(){var t=$("#dbv_main_js").attr("src").split("/");return t.pop(),t.join("/")}function dbv_loading_img(){return'<img style="padding: 28px" src="'+dbv_get_static_url()+'/../img/loading.gif">'}function dbv_loading_html(){return'<div style="text-align: center">'+dbv_loading_img()+"</div>"}function dbv_load_home_city(t){var a=t.shift();a&&($(".dbv_city_blk:last .dbv_next_btn .load-more").replaceWith(dbv_loading_img()),$(".dbv_city_blk:last .dbv_next_btn").css("text-align","center"),$.get("/dobovo/home/city.php?cmd=home&show_next_btn=1&lang="+dbv_get_current_lang()+"&city_id="+a,function(a){$(".dbv_city_blk:last .dbv_next_btn").hide(),$(".dbv_city_blk:last").after(a);var e=$(".dbv_city_blk:last>.js-masonry:first");e.masonry($.parseJSON(e.attr("data-masonry-options"))),dbv_change_currency(),dbv_load_home_city(t)}))}function dbv_get_reviews(t,a,e){$("#dbv_"+t+"_review_blk").html(dbv_loading_html()),$.get("/dobovo/apt/reviews.php?cmd=apt&type="+t+"&lang="+dbv_get_current_lang()+"&order="+e+"&apt_id="+a,function(a){$("#dbv_"+t+"_review_blk").html(a)})}function dbv_search_apt(t){var a=$(t).val();a.length>0?jQuery.getJSON("/tools/ajax.php",{search_apt:a},function(a){a.apt_id?window.location.href=a.apt_id:(a.hasOwnProperty("message")&&show_ajax_error(a.message),jQuery(t).val(""))}):jQuery(t).val("")}function dbv_get_current_lang(){return $("#dbv_lang_selector").parent().find(".currency__text").text()}function dbv_search(t){var a=$(t).parent(),e=a.find(".select_city .js-sel-input").val();$.get("/tools/ajax.php?get_city_url="+e,{},function(t){if(t){var e=$(".js-from").val().length?$(".js-datepicker-from").datepicker({dateFormat:"yy-mm-dd"}).val():null,n=$(".js-to").val().length?$(".js-datepicker-to").datepicker({dateFormat:"yy-mm-dd"}).val():null,d=a.find(".select_guest .js-sel-input").val(),r="";e&&n&&(r+="in="+e+"&out="+n),parseInt(d)>1&&(r&&(r+="&"),r+="persons="+d),r.length&&(r="?"+r),location.href=t+r}})}function dbv_get_calendar(t){data=new Object,data.id=parseInt($("#dbv_apt_id").text()),"object"==typeof dbv_aptCalendar&&("next"==t?dbv_aptCalendar.first_day.setMonth(dbv_aptCalendar.first_day.getMonth()+1):dbv_aptCalendar.first_day.setMonth(dbv_aptCalendar.first_day.getMonth()-1),data.date=dbv_DateToSQLFormat(dbv_aptCalendar.first_day)),$(".dbv_calendar_popup").show(),$.ajax({dataType:"json",url:"/dobovo/apt/ajax.php?action=getCalendar&lang="+dbv_get_current_lang(),data:data,method:"POST",error:function(t,a){$(".dbv_calendar_popup").hide(),show_ajax_error("We're sorry! Request has failed: "+a)},success:function(t){return $(".dbv_calendar_popup").hide(),t.hasOwnProperty("message")&&(show_ajax_error(t.message),$(".respond[item-id="+review_id+"]").find(".respond__like>span").hide()),1==t.success?(dbv_aptCalendar=t,dbv_update_apt_calendar(),void 0):void 0}})}function dbv_update_apt_calendar(){$("#dbv_calendar_first_month").html(dbv_aptCalendar.first_month),$("#dbv_calendar_last_month").html(dbv_aptCalendar.last_month);for(var t in dbv_aptCalendar.calendar)break;dbv_aptCalendar.first_day=dbv_DateClassFromSQL(t),dbv_aptCalendar.first_day.setDate(1);var a=new Date;if(a.setHours(0,0,0,0),"undefined"!=typeof dbv_aptCalendar.discounts&&0==$("#dbv_calendar_discounts").html().length){var e="";for(d in dbv_aptCalendar.discounts){var n=dbv_aptCalendar.discounts[d];e+="<div data-value="+n.discount+"><span>"+n.days+" "+n.text+"</span> -"+n.discount+"%</div>"}$("#dbv_calendar_discounts").html(e),$("#dbv_calendar_discounts>div").click(function(){$(this).hasClass("is-active")?($("#dbv_calendar_discounts>div").removeClass("is-active"),dbv_aptCalendarVars.discount=0):($("#dbv_calendar_discounts>div").removeClass("is-active"),$(this).addClass("is-active"),dbv_aptCalendarVars.discount=$(this).attr("data-value")),dbv_update_apt_calendar()})}for(var d=0;2>d;d++){var r=dbv_DateClassFromSQL(t);r=new Date(r.getFullYear(),r.getMonth()+d,1);var i=r.getDay()-1;0>i&&(i=6);for(var e="",s=0;i>s;s++)e+='<div class="cell is-other-month"></div>';var _=new Date(r);_.setMonth(_.getMonth()+1);for(var o=new Date(r);_>o;){var l="is-last-days",c=dbv_DateToSQLFormat(o),v=new Array;if(v.push('<a href="#">'),v.push("<span>"+o.getDate()+"</span>"),dbv_aptCalendar.calendar[c]){l=dbv_aptCalendar.calendar[c].state<1?"is-inactive":"";var p="undefined"==typeof dbv_aptCalendarVars.discount?dbv_aptCalendar.calendar[c].price:dbv_aptCalendar.calendar[c].price*(100-dbv_aptCalendarVars.discount)/100;v.push('<i class="dbv_price_round"><span class=dbv_cur>UAH</span><span class=dbv_val>'+p+"</span></i>")}v.push("</a>"),dbv_DateToSQLFormat(o)==dbv_DateToSQLFormat(a)&&(l+=" is-today"),a>o&&(l="is-last-days"),e+='<div class="cell '+l+'">'+v.join("")+"</div>",o.setTime(o.getTime()+864e5),i++}for(var s=i;42>s;s++)e+='<div class="cell is-other-month"></div>';$("#dbv_calendar_month"+d).html(e)}dbv_change_currency()}function dbv_DateToSQLFormat(t){return("000"+t.getFullYear()).slice(-4)+"-"+("0"+(1+t.getMonth())).slice(-2)+"-"+("0"+t.getDate()).slice(-2)}function dbv_DateClassFromSQL(t){return t=t.split("-"),new Date(t[0],t[1]-1,t[2])}function dbv_review_like(t){data=new Object,data.id=t,$.ajax({dataType:"json",url:"/dobovo/apt/ajax.php?action=reviewLike",data:data,method:"POST",error:function(t,a){show_ajax_error("We're sorry! Request has failed: "+a)},success:function(a){a.message&&(show_ajax_error(a.message),$(".respond[item-id="+t+"]").find(".respond__like>span").hide()),1==a.success&&(likes_el=$(".respond[item-id="+t+"]").find(".respond__like>i"),likes_el.html(parseInt(likes_el.text())+1),$(".respond[item-id="+t+"]").find(".respond__like>span").hide())}})}function show_ajax_error(t){var a="JSmessage_"+parseInt(1e6*Math.random());$("body").prepend("<div class=dbv_JS_message id="+a+"></div>"),$("#"+a).html('<button onClick="$(this).parent().hide()"></button>'+t).slideDown(500).delay(2e3).fadeOut(500,function(){$(this).remove()})}function dbv_livechat_init(){__lc_buttons.push({elementId:__lc.dbv_chatID,skill:"0",window:{width:500,height:520},type:"text",labels:{online:$("#"+__lc.dbv_chatID).attr("data-online"),offline:$("#"+__lc.dbv_chatID).attr("data-online")}});var t=("https:"==document.location.protocol?"https://":"http://")+"cdn.livechatinc.com/tracking.js";$.getScript(t)}$(document).ready(function(){dbv_load_currency_rates(),display_seo_text(),lang_propose(),dbv_livechat_init(),dbv_get_calendar("current")});var dbv_aptCalendar,dbv_aptCalendarVars=new Object,__lc={},__lc_buttons=[];__lc.license=1039501,__lc.dbv_chatID="LiveChat_1390310997";